!function(t){"use strict";var n,e,r,o,i=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=tinymce.util.Tools.resolve("tinymce.util.VK"),c=function(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n}(n)===t}},a=c("string"),l=c("array"),f=c("boolean"),s=c("function"),d=function(t){var n=t.getParam("link_assume_external_targets",!1);return f(n)&&n?1:!a(n)||"http"!==n&&"https"!==n?0:n},m=function(t){return t.getParam("link_context_toolbar",!1,"boolean")},p=function(t){return t.getParam("link_list")},h=function(t){return t.getParam("default_link_target")},g=function(t){return t.getParam("target_list",!0)},v=function(t){return t.getParam("rel_list",[],"array")},y=function(t){return t.getParam("link_class_list",[],"array")},k=function(t){return t.getParam("link_title",!0,"boolean")},b=function(t){return t.getParam("allow_unsafe_link_target",!1,"boolean")},w=function(t){return t.getParam("link_quicklink",!1,"boolean")},x=function(n){var e=t.document.createElement("a");e.target="_blank",e.href=n,e.rel="noreferrer noopener";var r=t.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,t.window,0,0,0,0,0,!1,!1,!1,!1,0,null),function(n,e){t.document.body.appendChild(n),n.dispatchEvent(e),t.document.body.removeChild(n)}(e,r)},_=function(){return(_=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},T=function(){},O=function(t){return function(){return t}},A=O(!1),C=O(!0),S=function(){return P},P=(n=function(t){return t.isNone()},o={fold:function(t,n){return t()},is:A,isSome:A,isNone:C,getOr:r=function(t){return t},getOrThunk:e=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:O(null),getOrUndefined:O(void 0),or:r,orThunk:e,map:S,each:T,bind:S,exists:A,forall:C,filter:S,equals:n,equals_:n,toArray:function(){return[]},toString:O("none()")},Object.freeze&&Object.freeze(o),o),E=function(t){var n=O(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:C,isNone:A,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return E(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:P},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(A,function(n){return e(t,n)})}};return o},L={some:E,none:S,from:function(t){return null==t?P:E(t)}},N=Array.prototype.slice,I=Array.prototype.indexOf,j=Array.prototype.push,D=function(t,n){return e=t,r=n,I.call(e,r)>-1;var e,r},F=function(t,n){for(var e=0,r=t.length;e<r;e++){n(t[e],e)}},R=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!l(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);j.apply(n,t[e])}return n},M=function(t,n){var e=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r}(t,n);return R(e)},U=(s(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.Tools")),z=function(t){return/^\w+:/i.test(t)},q=function(t,n){var e=["noopener"],r=t?t.split(/\s+/):[],o=function(t){return t.filter(function(t){return-1===U.inArray(e,t)})},i=n?function(t){return(t=o(t)).length>0?t.concat(e):e}(r):o(r);return i.length>0?function(t){return U.trim(t.sort().join(" "))}(i):""},B=function(t,n){return n=n||t.selection.getNode(),V(n)?t.dom.select("a[href]",n)[0]:t.dom.getParent(n,"a[href]")},K=function(t){return t&&"A"===t.nodeName&&!!t.href},V=function(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)},W=function(t){return n=["title","rel","class","target"],e=function(n,e){return t[e].each(function(t){n[e]=t.length>0?t:null}),n},r={href:t.href},F(n,function(t){r=e(r,t)}),r;var n,e,r},G=function(t,n){var e,r,o=_({},n);if(!(v(t).length>0)&&!1===b(t)){var i=q(o.rel,"_blank"===o.target);o.rel=i||null}return L.from(o.target).isNone()&&!1===g(t)&&(o.target=h(t)),o.href=(e=o.href,"http"!==(r=d(t))&&"https"!==r||z(e)?e:r+"://"+e),o},H=function(t,n){var e=t.dom.select("img",n)[0];if(e){var r=t.dom.getParents(e,"a[href]",n)[0];r&&(r.parentNode.insertBefore(e,r),t.dom.remove(r))}},$=function(t,n,e){var r=t.dom.select("img",n)[0];if(r){var o=t.dom.create("a",e);r.parentNode.insertBefore(o,r),o.appendChild(r)}},J=function(t,n,e){var r=t.selection.getNode(),o=B(t,r),i=G(t,W(e));t.undoManager.transact(function(){e.href===n.href&&n.attach(),o?(t.focus(),function(t,n,e,r){e.each(function(t){n.hasOwnProperty("innerText")?n.innerText=t:n.textContent=t}),t.dom.setAttribs(n,r),t.selection.select(n)}(t,o,e.text,i)):function(t,n,e,r){V(n)?$(t,n,r):e.fold(function(){t.execCommand("mceInsertLink",!1,r)},function(n){t.insertContent(t.dom.createHTML("a",r,t.dom.encode(n)))})}(t,r,e.text,i)})},X=function(t){t.undoManager.transact(function(){var n=t.selection.getNode();if(V(n))H(t,n);else{var e=t.dom.getParent(n,"a[href]",t.getBody());e&&t.dom.remove(e,!0)}t.focus()})},Q=K,Y=function(t){return U.grep(t,K).length>0},Z=function(t){var n=t.getAttribute("data-mce-href");return n||t.getAttribute("href")},tt=function(t){return!(/</.test(t)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(t)||-1===t.indexOf("href=")))},nt=B,et=function(t,n){return function(t){return t.replace(/\uFEFF/g,"")}(n?n.innerText||n.textContent:t.getContent({format:"text"}))},rt=q,ot=z,it=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},ut=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return L.none()},ct=function(t){return a(t.value)?t.value:""},at=function(t){return void 0===t&&(t=ct),function(n){return L.from(n).map(function(n){return function(t,n){var e=[];return U.each(t,function(t){var r=a(t.text)?t.text:a(t.title)?t.title:"";if(void 0!==t.menu);else{var o=n(t);e.push({text:r,value:o})}}),e}(n,t)})}},lt={sanitize:function(t){return at(ct)(t)},sanitizeWith:at,createUi:function(t,n){return function(e){return{name:t,type:"selectbox",label:n,items:e}}},getValue:ct},ft=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return ft(e())}}},st=function(t,n,e,r){var o=r[n],i=t.length>0;return void 0!==o?function(t,n){return ut(n,function(n){return L.some(n).filter(function(n){return n.value===t})})}(o,e).map(function(n){return{url:{value:n.value,meta:{text:i?t:n.text,attach:T}},text:i?t:n.text}}):L.none()},dt=function(t,n){var e=ft(t.text),r=function(t,r){var o,i,u=(o=n,i=r.name,"link"===i?o.catalogs.link:"anchor"===i?o.catalogs.anchor:L.none()).getOr([]);return st(e.get(),r.name,u,t)};return{onChange:function(t,n){return"url"===n.name?function(t){if(e.get().length<=0){var n=void 0!==t.url.meta.text?t.url.meta.text:t.url.value;return L.some({text:n})}return L.none()}(t()):D(["anchor","link"],n.name)?r(t(),n):"text"===n.name?(e.set(t().text),L.none()):L.none()}}},mt={},pt={exports:mt};!function(t,n,e,r){!function(r){if("object"==typeof n&&void 0!==e)e.exports=r();else if("function"==typeof t&&t.amd)t([],r);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=r()}}(function(){return function(){return function t(n,e,o){function i(c,a){if(!e[c]){if(!n[c]){var l="function"==typeof r&&r;if(!a&&l)return l(c,!0);if(u)return u(c,!0);var f=new Error("Cannot find module '"+c+"'");throw f.code="MODULE_NOT_FOUND",f}var s=e[c]={exports:{}};n[c][0].call(s.exports,function(t){return i(n[c][1][t]||t)},s,s.exports,t,n,e,o)}return e[c].exports}for(var u="function"==typeof r&&r,c=0;c<o.length;c++)i(o[c]);return i}}()({1:[function(t,n,e){var r,o,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(n){try{return r.call(null,t,0)}catch(n){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(t){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(t){o=c}}();var l,f=[],s=!1,d=-1;function m(){s&&l&&(s=!1,l.length?f=l.concat(f):d=-1,f.length&&p())}function p(){if(!s){var t=a(m);s=!0;for(var n=f.length;n;){for(l=f,f=[];++d<n;)l&&l[d].run();d=-1,n=f.length}l=null,s=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(n){try{return o.call(null,t)}catch(n){return o.call(this,t)}}}(t)}}function h(t,n){this.fun=t,this.array=n}function g(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];f.push(new h(t,n)),1!==f.length||s||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){!function(e){var r=setTimeout;function o(){}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(t,this)}function u(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var r;try{r=e(t._value)}catch(t){return void a(n.promise,t)}c(n.promise,r)}else(1===t._state?c:a)(n.promise,t._value)})):t._deferreds.push(n)}function c(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof i)return t._state=3,t._value=n,void l(t);if("function"==typeof e)return void s((r=e,o=n,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=n,l(t)}catch(n){a(t,n)}var r,o}function a(t,n){t._state=2,t._value=n,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;n<e;n++)u(t,t._deferreds[n]);t._deferreds=null}function f(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function s(t,n){var e=!1;try{t(function(t){e||(e=!0,c(n,t))},function(t){e||(e=!0,a(n,t))})}catch(t){if(e)return;e=!0,a(n,t)}}i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,n){var e=new this.constructor(o);return u(this,new f(t,n,e)),e},i.all=function(t){var n=Array.prototype.slice.call(t);return new i(function(t,e){if(0===n.length)return t([]);var r=n.length;function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,function(t){o(i,t)},e)}n[i]=u,0==--r&&t(n)}catch(t){e(t)}}for(var i=0;i<n.length;i++)o(i,n[i])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(n){n(t)})},i.reject=function(t){return new i(function(n,e){e(t)})},i.race=function(t){return new i(function(n,e){for(var r=0,o=t.length;r<o;r++)t[r].then(n,e)})},i._immediateFn="function"==typeof t?function(n){t(n)}:function(t){r(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},void 0!==n&&n.exports?n.exports=i:e.Promise||(e.Promise=i)}(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,r){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,c={},a=0;function l(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new l(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new l(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},e.setImmediate="function"==typeof n?n:function(t){var n=a++,r=!(arguments.length<2)&&u.call(arguments,1);return c[n]=!0,o(function(){c[n]&&(r?t.apply(null,r):t.call(null),e.clearImmediate(n))}),n},e.clearImmediate="function"==typeof r?r:function(t){delete c[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var r=t("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)})}(void 0,mt,pt,void 0);var ht=pt.exports.boltExport,gt=function(n){var e=L.none(),r=[],o=function(t){i()?c(t):r.push(t)},i=function(){return e.isSome()},u=function(t){F(t,c)},c=function(n){e.each(function(e){t.setTimeout(function(){n(e)},0)})};return n(function(t){e=L.some(t),u(r),r=[]}),{get:o,map:function(t){return gt(function(n){o(function(e){n(t(e))})})},isReady:i}},vt={nu:gt,pure:function(t){return gt(function(n){n(t)})}},yt=function(n){t.setTimeout(function(){throw n},0)},kt=function(t){var n=function(n){t().then(n,yt)};return{map:function(n){return kt(function(){return t().then(n)})},bind:function(n){return kt(function(){return t().then(function(t){return n(t).toPromise()})})},anonBind:function(n){return kt(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return vt.nu(n)},toCached:function(){var n=null;return kt(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},bt=function(t){return kt(function(){return new ht(t)})},wt=function(t){return kt(function(){return ht.resolve(t)})},xt=tinymce.util.Tools.resolve("tinymce.util.Delay"),_t=function(t){var n=t.href;return n.indexOf("@")>0&&-1===n.indexOf("//")&&-1===n.indexOf("mailto:")?L.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(t){return _(_({},t),{href:"mailto:"+n})}}):L.none()},Tt=function(t){return function(n){var e=n.href;return 1===t&&!ot(e)||0===t&&/^\s*www[\.|\d\.]/i.test(e)?L.some({message:"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",preprocess:function(t){return _(_({},t),{href:"http://"+e})}}):L.none()}},Ot=function(t,n,e){return ut([_t,Tt(n)],function(t){return t(e)}).fold(function(){return wt(e)},function(n){return bt(function(r){!function(t,n,e){var r=t.selection.getRng();xt.setEditorTimeout(t,function(){t.windowManager.confirm(n,function(n){t.selection.setRng(r),e(n)})})}(t,n.message,function(t){r(t?n.preprocess(e):e)})})})},At=function(t){var n=t.dom.select("a:not([href])"),e=M(n,function(t){var n=t.name||t.id;return n?[{text:n,value:"#"+n}]:[]});return e.length>0?L.some([{text:"None",value:""}].concat(e)):L.none()},Ct=function(t){var n=y(t);return n.length>0?lt.sanitize(n):L.none()},St=tinymce.util.Tools.resolve("tinymce.util.XHR"),Pt=function(t){var n=function(n){return t.convertURL(n.value||n.url,"href")},e=p(t);return bt(function(t){a(e)?St.send({url:e,success:function(n){return t(function(t){try{return L.some(JSON.parse(t))}catch(t){return L.none()}}(n))},error:function(n){return t(L.none())}}):s(e)?e(function(n){return t(L.some(n))}):t(L.from(e))}).map(function(t){return t.bind(lt.sanitizeWith(n)).map(function(t){return t.length>0?[{text:"None",value:""}].concat(t):t})})},Et=function(t,n){var e=v(t);if(e.length>0){var r=n.is("_blank");return(!1===b(t)?lt.sanitizeWith(function(t){return rt(lt.getValue(t),r)}):lt.sanitize)(e)}return L.none()},Lt=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],Nt=function(t){var n=g(t);return l(n)?lt.sanitize(n).orThunk(function(){return L.some(Lt)}):!1===n?L.none():L.some(Lt)},It=function(t,n,e){var r=t.getAttrib(n,e);return null!==r&&r.length>0?L.some(r):L.none()},jt=function(t,n){return Pt(t).map(function(e){var r=function(t,n){var e=t.dom,r=tt(t.selection.getContent())?L.some(et(t.selection,n)):L.none(),o=n?L.some(e.getAttrib(n,"href")):L.none(),i=n?L.from(e.getAttrib(n,"target")):L.none(),u=It(e,n,"rel"),c=It(e,n,"class");return{url:o,text:r,title:It(e,n,"title"),target:i,rel:u,linkClass:c}}(t,n);return{anchor:r,catalogs:{targets:Nt(t),rels:Et(t,r.target),classes:Ct(t),anchor:At(t),link:e},optNode:L.from(n),flags:{titleEnabled:k(t)}}})},Dt=function(t){(function(t){var n=nt(t);return jt(t,n)})(t).map(function(n){var e=function(t,n,e){return function(r){var o=r.getData();if(!o.url.value)return X(t),void r.close();var i=function(t){return L.from(o[t]).filter(function(e){return!n.anchor[t].is(e)})},u={href:o.url.value,text:i("text"),target:i("target"),rel:i("rel"),class:i("linkClass"),title:i("title")},c={href:o.url.value,attach:void 0!==o.url.meta&&o.url.meta.attach?o.url.meta.attach:function(){}};Ot(t,e,u).get(function(n){J(t,c,n)}),r.close()}}(t,n,d(t));return function(t,n,e){var r=t.anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),o=t.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],i=function(t,n){return{url:{value:t.anchor.url.getOr(""),meta:{attach:function(){},text:t.anchor.url.fold(function(){return""},function(){return t.anchor.text.getOr("")}),original:{value:t.anchor.url.getOr("")}}},text:t.anchor.text.getOr(""),title:t.anchor.title.getOr(""),anchor:t.anchor.url.getOr(""),link:t.anchor.url.getOr(""),rel:t.anchor.rel.getOr(""),target:t.anchor.target.or(n).getOr(""),linkClass:t.anchor.linkClass.getOr("")}}(t,L.from(h(e))),u=dt(i,t),c=t.catalogs;return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:R([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],r,o,it([c.anchor.map(lt.createUi("anchor","Anchors")),c.rels.map(lt.createUi("rel","Rel")),c.targets.map(lt.createUi("target","Open link in...")),c.link.map(lt.createUi("link","Link list")),c.classes.map(lt.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onChange:function(t,n){var e=n.name;u.onChange(t.getData,{name:e}).each(function(n){t.setData(n)})},onSubmit:n}}(n,e,t)}).get(function(n){t.windowManager.open(n)})},Ft=function(t,n){return t.dom.getParent(n,"a[href]")},Rt=function(t){return Ft(t,t.selection.getStart())},Mt=function(t,n){if(n){var e=Z(n);if(/^#/.test(e)){var r=t.$(e);r.length&&t.selection.scrollIntoView(r[0],!0)}else x(n.href)}},Ut={openDialog:function(t){return function(){Dt(t)}},gotoSelectedLink:function(t){return function(){Mt(t,Rt(t))}},leftClickedOnAHref:function(t){return function(n){var e,r,o;return!!(m(t)&&Q(n)&&3===(o=(r=(e=t.selection).getRng()).startContainer).nodeType&&e.isCollapsed()&&r.startOffset>0&&r.startOffset<o.data.length)}},setupGotoLinks:function(t){t.on("click",function(n){var e=Ft(t,n.target);e&&u.metaKeyPressed(n)&&(n.preventDefault(),Mt(t,e))}),t.on("keydown",function(n){var e=Rt(t);e&&13===n.keyCode&&function(t){return!0===t.altKey&&!1===t.shiftKey&&!1===t.ctrlKey&&!1===t.metaKey}(n)&&(n.preventDefault(),Mt(t,e))})},toggleActiveState:function(t){return function(n){var e=function(e){return n.setActive(!t.readonly&&!!nt(t,e.element))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}},toggleEnabledState:function(t){return function(n){n.setDisabled(!Y(t.dom.getParents(t.selection.getStart())));var e=function(t){return n.setDisabled(!Y(t.parents))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}}},zt={register:function(t){t.addCommand("mceLink",function(){w(t)?t.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):Ut.openDialog(t)()})}},qt={setup:function(t){t.addShortcut("Meta+K","",function(){t.execCommand("mceLink")})}},Bt={setupButtons:function(t){t.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:Ut.openDialog(t),onSetup:Ut.toggleActiveState(t)}),t.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:Ut.gotoSelectedLink(t),onSetup:Ut.toggleEnabledState(t)}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return X(t)},onSetup:Ut.toggleEnabledState(t)})},setupMenuItems:function(t){t.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:Ut.gotoSelectedLink(t),onSetup:Ut.toggleEnabledState(t)}),t.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:Ut.openDialog(t)}),t.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return X(t)},onSetup:Ut.toggleEnabledState(t)})},setupContextMenu:function(t){t.ui.registry.addContextMenu("link",{update:function(n){return Y(t.dom.getParents(n,"a"))?"link unlink openlink":"link"}})},setupContextToolbars:function(t){var n=function(n){var e=t.selection.getNode();return n.setDisabled(!nt(t,e)),function(){}};t.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Ut.toggleActiveState(t)},label:"Link",predicate:function(n){return!!nt(t,n)&&m(t)},initValue:function(){var n=nt(t);return n?Z(n):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(n){var e=t.selection.getNode();return n.setActive(!!nt(t,e)),Ut.toggleActiveState(t)(n)},onAction:function(n){var e=nt(t),r=n.getValue();if(e)t.dom.setAttrib(e,"href",r),function(t){t.selection.collapse(!1)}(t),n.hide();else{var o={href:r,attach:function(){}},i=tt(t.selection.getContent())?L.some(et(t.selection,e)).filter(function(t){return t.length>0}).or(L.from(r)):L.none();J(t,o,{href:r,text:i,title:L.none(),rel:L.none(),target:L.none(),class:L.none()}),n.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:n,onAction:function(n){X(t),n.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:n,onAction:function(n){Ut.gotoSelectedLink(t)(),n.hide()}}]})}};i.add("link",function(t){Bt.setupButtons(t),Bt.setupMenuItems(t),Bt.setupContextMenu(t),Bt.setupContextToolbars(t),Ut.setupGotoLinks(t),zt.register(t),qt.setup(t)})}(window);